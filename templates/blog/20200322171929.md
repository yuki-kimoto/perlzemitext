<h2>非常に大きなファイルの処理 part.5 - 余計なデータ出力を制御しよう -</h2>

[前回](/blog/20200317085315.html)の最後では、余計な出力が残っていました。

削除していきましょう。

### 前回の出力結果

<pre>
Argument "sales" isn't numeric in addition (+) at proc_data.pl line 11, <> line 1.
year, sales
year, 0
2019, 1000
2019, 1000
2019, 2000
2019, 3000
2019, 3000
2019, 6000
</pre>

### 欲しい出力結果

<pre>
year,sales
2019,6000
</pre>

### データ処理コード(proc\_data.pl)

<pre>
#! /usr/bin/env perl
use strict;
use warnings;

my $sales = 0;
my $is_header = 1;
my $year = '';
while (my $line = <>) {
  chomp $line;
  my @row = split /,/, $line;

  if ($is_header) {
    print "$row[0], $row[2]\n";
    $is_header = 0;
    next;
  }

  $year = $row[0];
  $sales += $row[2];
}
print "$year, $sales\n";
</pre>

### コード実行

<pre>
$ perl proc_data.pl data.csv
</pre>

### 出力結果

<pre>
year,sales
2019,6000
</pre>

<br>
欲しい結果と同じになりましたね！

しかし、データ処理コードが複雑になりました。頭を整理するため、次回は複雑になった箇所を解説していきます。